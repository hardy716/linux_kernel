|0. linux_kernel [ğŸ”»](https://github.com/hardy716/linux_kernel#0%EF%B8%8Fâƒ£--linux_kernel)|
|---|

|1. ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í’€ê¸° [ğŸ”»](https://github.com/hardy716/linux_kernel#1%EF%B8%8Fâƒ£--ë¦¬ëˆ…ìŠ¤-ì»¤ë„-ì†ŒìŠ¤-ë‹¤ìš´ë¡œë“œ-ë°-ì••ì¶•-í’€ê¸°)|
|---|

|2. ì†ŒìŠ¤ì— ì‹œìŠ¤í…œ ì½œ ì¶”ê°€ [ğŸ”»](https://github.com/hardy716/linux_kernel#2%EF%B8%8Fâƒ£--ì†ŒìŠ¤ì—-ì‹œìŠ¤í…œ-ì½œ-ì¶”ê°€)|
|---|

|3. ì¶”ê°€í•œ ì‹œìŠ¤í…œ ì½œì„ ì»´íŒŒì¼ í•˜ê¸° ìœ„í•œ í™˜ê²½ ì„¸íŒ… [ğŸ”»](https://github.com/hardy716/linux_kernel#3%EF%B8%8Fâƒ£--ì¶”ê°€í•œ-ì‹œìŠ¤í…œ-ì½œì„-ì»´íŒŒì¼-í•˜ê¸°-ìœ„í•œ-í™˜ê²½-ì„¸íŒ…)|
|---|

|4. ì†ŒìŠ¤ ì½”ë“œ ì˜®ê¸°ê³  ê³„ì† ì»´íŒŒì¼ í™˜ê²½ ì„¤ì • [ğŸ”»](https://github.com/hardy716/linux_kernel#4%EF%B8%8Fâƒ£--ì†ŒìŠ¤-ì½”ë“œ-ì˜®ê¸°ê³ -ê³„ì†-ì»´íŒŒì¼-í™˜ê²½-ì„¤ì •)|
|---|

|5. ì»´íŒŒì¼ [ğŸ”»](https://github.com/hardy716/linux_kernel#5%EF%B8%8Fâƒ£--ì»´íŒŒì¼)|
|---|

|6. ì»´íŒŒì¼í•œ ì»¤ë„ì„ OSì— ì„¤ì¹˜ [ğŸ”»](https://github.com/hardy716/linux_kernel#6%EF%B8%8Fâƒ£--ì»´íŒŒì¼í•œ-ì»¤ë„ì„-osì—-ì„¤ì¹˜)|
|---|

|7. ì¶”ê°€í•œ ì‹œìŠ¤í…œ ì½œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ê¸°(ìœ ì € ë ˆë²¨) [ğŸ”»](https://github.com/hardy716/linux_kernel#7%EF%B8%8Fâƒ£--ì¶”ê°€í•œ-ì‹œìŠ¤í…œ-ì½œì´-ì •ìƒì ìœ¼ë¡œ-ì‘ë™í•˜ëŠ”ì§€-í™•ì¸í•´ë³´ê¸°ìœ ì €-ë ˆë²¨)|
|---|

<br></br>

## 0ï¸âƒ£  linux_kernel

ê°€ìƒí™˜ê²½ì¸ VMwareì—ì„œ 64-bit ìš°ë¶„íˆ¬(Ubuntu)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ ì»´íŒŒì¼ê³¼ ì‹œìŠ¤í…œ ì½œ ì¶”ê°€ ì‘ì—…ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

1. ë¦¬ëˆ…ìŠ¤ ì»¤ë„:
ì»¤ë„ì€ ìš´ì˜ ì²´ì œì˜ í•µì‹¬ ë¶€ë¶„ìœ¼ë¡œ, í•˜ë“œì›¨ì–´ì™€ ì†Œí”„íŠ¸ì›¨ì–´ ê°„ì˜ ìƒí˜¸ ì‘ìš©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. ì»¤ë„ì€ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤(ì˜ˆ: ë©”ëª¨ë¦¬, CPU ì‹œê°„)ë¥¼ í• ë‹¹í•˜ê³ , ì¥ì¹˜ ë“œë¼ì´ë²„ë¥¼ ê´€ë¦¬í•˜ë©°, ì‚¬ìš©ìì™€ ì‹œìŠ¤í…œ ê°„ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•©ë‹ˆë‹¤.

3. ì»¤ë„ ì»´íŒŒì¼:
ì»¤ë„ ì»´íŒŒì¼ì€ ì»¤ë„ ì†ŒìŠ¤ ì½”ë“œë¥¼ ê¸°ê³„ì–´ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì„ ë§í•©ë‹ˆë‹¤. ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì€ ë‹¤ì–‘í•œ ì„¤ì • ì˜µì…˜ì„ ì œê³µí•˜ë¯€ë¡œ, ì‚¬ìš©ìëŠ” ì´ëŸ¬í•œ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ì»¤ë„ì„ ì»¤ìŠ¤í…€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¤ë„ì„ ì»´íŒŒì¼í•˜ë©´, í•´ë‹¹ ì‹œìŠ¤í…œì— ìµœì í™”ëœ ì»¤ë„ì„ ì–»ì„ ìˆ˜ ìˆìœ¼ë©°, í•„ìš”í•˜ì§€ ì•Šì€ ê¸°ëŠ¥ì„ ì œê±°í•˜ê±°ë‚˜ ì¶”ê°€ì ì¸ ê¸°ëŠ¥ì„ í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

4. ì‹œìŠ¤í…œ ì½œ ì¶”ê°€:
ì‚¬ìš©ì ê³µê°„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì»¤ë„ ê³µê°„ ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í”„ë¡œê·¸ë¨ì€ ì»¤ë„ì—ê²Œ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤(ì˜ˆ: íŒŒì¼ ì‘ì„±, ë©”ëª¨ë¦¬ í• ë‹¹)ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‹œìŠ¤í…œ ì½œì„ ì¶”ê°€í•œë‹¤ëŠ” ê²ƒì€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ì»¤ë„ì— ì¶”ê°€í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì •í•œ í•˜ë“œì›¨ì–´ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê±°ë‚˜, ìƒˆë¡œìš´ ë°©ì‹ì˜ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì€ ìš´ì˜ ì²´ì œì˜ ì¤‘ì‹¬ì ì¸ ë¶€ë¶„ì´ë©°, ì»¤ë„ ì»´íŒŒì¼ì€ ì´ ì»¤ë„ì„ íŠ¹ì • í™˜ê²½ì— ë§ê²Œ ìµœì í™”í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. 
ì‹œìŠ¤í…œ ì½œì„ ì¶”ê°€í•˜ë©´ ì»¤ë„ì˜ ê¸°ëŠ¥ì„ í™•ì¥í•˜ì—¬ ì‚¬ìš©ì ì• í”Œë¦¬ì¼€ì´ì…˜ì— ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br></br>

## 1ï¸âƒ£  ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í’€ê¸°

```
wget https://mirros.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.18.16.tar.xz  // ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ
tar xvf linux-5.18.16.tar.xz  // ì••ì¶• í’€ê¸°
cd linux-5.18.16
```

<br></br>

## 2ï¸âƒ£  ì†ŒìŠ¤ì— ì‹œìŠ¤í…œ ì½œ ì¶”ê°€

```
cd kernel
nano mycall.c
```

![l1](https://github.com/hardy716/linux_kernel/assets/101140679/b65298ac-f620-4e6b-9216-b178c7fe76ee)

<br></br>

## 3ï¸âƒ£  ì¶”ê°€í•œ ì‹œìŠ¤í…œ ì½œì„ ì»´íŒŒì¼ í•˜ê¸° ìœ„í•œ í™˜ê²½ ì„¸íŒ…

```
nano Makefile
```

![l2](https://github.com/hardy716/linux_kernel/assets/101140679/ead27db9-4a45-4857-8007-e1a403ed3882)

```
cd ..
cd ./arch/x86/entry/syscalls
nano syscall_64.tbl
```
![l3](https://github.com/hardy716/linux_kernel/assets/101140679/4ea22ab5-a812-4ae6-9fcd-f7dfef84bd0b)

```
cd ../../../..
cd ./include/linux
nano syscalls.h
```
![l4](https://github.com/hardy716/linux_kernel/assets/101140679/3bd96836-5d87-421a-862c-7eb08ffdcddb)

<br></br>

## 4ï¸âƒ£  ì†ŒìŠ¤ ì½”ë“œ ì˜®ê¸°ê³  ê³„ì† ì»´íŒŒì¼ í™˜ê²½ ì„¤ì •

```
sudo apt-get install git fakeroot build-essential ncurses-dev xz-utils libssl-dev flex libelf-dev bison
cd ~ (tar íŒŒì¼ ë°›ì€ ê²½ë¡œë¡œ ì´ë™í•˜ê¸°)
sudo cp -r linux-5.18.16/usr/src/linux-5.18.16
```

```
cd /usr/src/linux-5.18.16
sudo cp /boot/config-$(uname -r) .config
sudo make menuconfig
```

```
// ë§Œì•½ ì•„ë˜ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ë©´, ë””ìŠ¤í”Œë ˆì´ í¬ê¸° ë³€ê²½í•˜ê³  í•´ìƒë„ë„ 100%ë¡œ ì¤„ì¼ ê²ƒ
Your display is too small to run Menuconfig!
It must be at least 19 lines by 80 columns.

// ì •ìƒì ìœ¼ë¡œ ì°½ì´ ëœ¨ë©´, load -> save -> exit
```

```
sudo nano .config

// ì•„ë˜ì™€ ê°™ì´ í•´ë‹¹ í•­ëª©ë“¤ì˜ ê°’ì„ ""ë¡œ ë³€ê²½
CONFIG_SYSTEM_TRUSTED_KEYS=""
CONFIG_SYSTEM_REVOCATION_KEYS=""
```

<br></br>

## 5ï¸âƒ£  ì»´íŒŒì¼

```
sudo make -j8  // ì»´íŒŒì¼ ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ ê°œìˆ˜ë¥¼ 8ë¡œ ì„¤ì •
```
![l5](https://github.com/hardy716/linux_kernel/assets/101140679/9e92743c-58e4-489e-ab2a-5843be897065)

ì¤‘ê°„ì— ìœ„ì™€ ê°™ì€ ë©”ì‹œì§€ê°€ ëœ¨ì§€ ì•ŠëŠ” ê²½ìš°, ì˜¤íƒ€ê°€ ë‚¬ì„ í™•ë¥ ì´ ë†’ìœ¼ë¯€ë¡œ ì¬í™•ì¸ í•„ìš”!

```
sudo make modules_install -j8  // ì»´íŒŒì¼ ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ ê°œìˆ˜ë¥¼ 8ë¡œ ì„¤ì •
```
![l6](https://github.com/hardy716/linux_kernel/assets/101140679/5d2b0bee-cb86-4f90-9cd3-2cd1fbed86dc)

ì‹¤í–‰ ê²°ê³¼ í™•ì¸

<br></br>

## 6ï¸âƒ£  ì»´íŒŒì¼í•œ ì»¤ë„ì„ OSì— ì„¤ì¹˜

![l7](https://github.com/hardy716/linux_kernel/assets/101140679/c346ad2a-57d4-41a4-a45c-c558235ed880)

ê·¸ ì „ì˜ ì»¤ë„ ë²„ì „

![l8](https://github.com/hardy716/linux_kernel/assets/101140679/83605867-8a05-4f47-b8d6-5019e66b1365)

ìƒˆë¡œìš´ ì»¤ë„ ì„¤ì¹˜í•˜ê¸°

![l9](https://github.com/hardy716/linux_kernel/assets/101140679/84f53cc4-77f0-47ef-bea6-faf765c2fdd6)

```
sudo reboot
```

![l10](https://github.com/hardy716/linux_kernel/assets/101140679/522b3138-fda1-4eaf-b624-4b84fa756cea)

<br></br>

## 7ï¸âƒ£  ì¶”ê°€í•œ ì‹œìŠ¤í…œ ì½œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ê¸°(ìœ ì € ë ˆë²¨)

```
nano systest.c
```

![l11](https://github.com/hardy716/linux_kernel/assets/101140679/05339f23-3d0b-4349-adef-7453e8180c08)

```
gcc -o systest.out systest.c
```

![l12](https://github.com/hardy716/linux_kernel/assets/101140679/1a66ba64-e3a3-42d3-8594-c58858c1e319)

```
sudo dmesg  // ì»¤ë„ ë©”ì‹œì§€ í™•ì¸(SYSCALL_DEFINE1, SYSCALL_DEFINE0)
```

![l13](https://github.com/hardy716/linux_kernel/assets/101140679/0fd98f14-e1f6-4142-836c-088d89471514)
